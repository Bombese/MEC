local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

-- ====== ScreenGui ======
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "BomHack_v1_ScreenGui"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = game.CoreGui -- or LocalPlayer:WaitForChild("PlayerGui") if prefer

-- ====== Main Frame (small) ======
local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 400, 0, 300)
MainFrame.Position = UDim2.new(0, 50, 0, 50)
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Visible = false

local mainCorner = Instance.new("UICorner", MainFrame)
mainCorner.CornerRadius = UDim.new(0, 12)
local mainStroke = Instance.new("UIStroke", MainFrame)
mainStroke.Color = Color3.fromRGB(160, 50, 255)
mainStroke.Thickness = 2
mainStroke.Transparency = 0.3

-- Title
local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1, -40, 0, 40)
Title.Position = UDim2.new(0, 10, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "Bom hack Beta v0.069 https://Discrod.gg/4JPgtddfHn"
Title.TextColor3 = Color3.fromRGB(220, 220, 255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 24
Title.TextXAlignment = Enum.TextXAlignment.Left

-- Close button
local CloseBtn = Instance.new("TextButton", MainFrame)
CloseBtn.Size = UDim2.new(0, 30, 0, 30)
CloseBtn.Position = UDim2.new(1, -35, 0, 5)
CloseBtn.BackgroundColor3 = Color3.fromRGB(80, 0, 0)
CloseBtn.Text = "X"
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.TextSize = 20
local closeCorner = Instance.new("UICorner", CloseBtn); closeCorner.CornerRadius = UDim.new(0,6)

-- Category frame (left)
local CategoryFrame = Instance.new("Frame", MainFrame)
CategoryFrame.Size = UDim2.new(0, 100, 0, 250)
CategoryFrame.Position = UDim2.new(0, 10, 0, 50)
CategoryFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
local catCorner = Instance.new("UICorner", CategoryFrame); catCorner.CornerRadius = UDim.new(0, 10)
local catStroke = Instance.new("UIStroke", CategoryFrame); catStroke.Color = Color3.fromRGB(160,50,255); catStroke.Thickness = 1; catStroke.Transparency = 0.4
local CategoryLayout = Instance.new("UIListLayout", CategoryFrame); CategoryLayout.SortOrder = Enum.SortOrder.LayoutOrder; CategoryLayout.Padding = UDim.new(0,5)

-- Content frame (right)
local ContentFrame = Instance.new("Frame", MainFrame)
ContentFrame.Size = UDim2.new(0, 270, 0, 250)
ContentFrame.Position = UDim2.new(0, 120, 0, 50)
ContentFrame.BackgroundColor3 = Color3.fromRGB(25,25,25)
local contentCorner = Instance.new("UICorner", ContentFrame); contentCorner.CornerRadius = UDim.new(0,10)
local contentStroke = Instance.new("UIStroke", ContentFrame); contentStroke.Color = Color3.fromRGB(160,50,255); contentStroke.Thickness = 1; contentStroke.Transparency = 0.4

-- Category title
local CategoryTitle = Instance.new("TextLabel", ContentFrame)
CategoryTitle.Size = UDim2.new(1, -10, 0, 25)
CategoryTitle.Position = UDim2.new(0,5,0,5)
CategoryTitle.BackgroundTransparency = 1
CategoryTitle.TextColor3 = Color3.fromRGB(220,220,255)
CategoryTitle.Font = Enum.Font.GothamBold
CategoryTitle.TextSize = 20
CategoryTitle.TextXAlignment = Enum.TextXAlignment.Left
CategoryTitle.Text = "หมวด: Teleport"

-- Helper to style buttons
local function styleButton(btn, textSize)
    btn.BackgroundColor3 = Color3.fromRGB(35,35,35)
    btn.TextColor3 = Color3.fromRGB(200,200,255)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = textSize or 18
    local corner = Instance.new("UICorner", btn); corner.CornerRadius = UDim.new(0,6)
    local stroke = Instance.new("UIStroke", btn); stroke.Color = Color3.fromRGB(160,50,255); stroke.Thickness = 1
    btn.MouseEnter:Connect(function() btn.BackgroundColor3 = Color3.fromRGB(60,30,80) end)
    btn.MouseLeave:Connect(function() btn.BackgroundColor3 = Color3.fromRGB(35,35,35) end)
end

-- Create category buttons
local function createCategory(name)
    local btn = Instance.new("TextButton", CategoryFrame)
    btn.Size = UDim2.new(1, 0, 0, 35)
    btn.Text = name
    styleButton(btn, 18)
    return btn
end

local TPBtn = createCategory("Teleport")
local ModBtn = createCategory("Mod")
local FlyBtn = createCategory("Fly")

-- --- Create content subframes so switching doesn't destroy GUIs ---
local TeleportContent = Instance.new("Frame", ContentFrame)
TeleportContent.Size = UDim2.new(1,0,1,0)
TeleportContent.BackgroundTransparency = 1
TeleportContent.Visible = false

local FlyContent = Instance.new("Frame", ContentFrame)
FlyContent.Size = UDim2.new(1,0,1,0)
FlyContent.BackgroundTransparency = 1
FlyContent.Visible = false

local ModContent = Instance.new("Frame", ContentFrame)
ModContent.Size = UDim2.new(1,0,1,0)
ModContent.BackgroundTransparency = 1
ModContent.Visible = false

-- Show/Hide utility
local function showCategory(frame, title)
    -- hide all
    for _, child in pairs(ContentFrame:GetChildren()) do
        if child:IsA("Frame") and child ~= CategoryTitle then
            child.Visible = false
        end
    end
    frame.Visible = true
    CategoryTitle.Text = title or "หมวด"
end

-- Player list factory (reusable)
local function createPlayerListInParent(parentFrame, callback)
    -- remove existing to avoid duplicates
    for _,c in pairs(parentFrame:GetChildren()) do
        if c.Name == "PlayerList" then c:Destroy() end
    end
    local PlayerList = Instance.new("ScrollingFrame", parentFrame)
    PlayerList.Name = "PlayerList"
    PlayerList.Size = UDim2.new(1, -10, 1, -40)
    PlayerList.Position = UDim2.new(0,5,0,30)
    PlayerList.BackgroundColor3 = Color3.fromRGB(40,40,40)
    PlayerList.BorderSizePixel = 0
    PlayerList.ScrollBarThickness = 6
    PlayerList.CanvasSize = UDim2.new(0,0,0,0)

    local ListLayout = Instance.new("UIListLayout", PlayerList)
    ListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    ListLayout.Padding = UDim.new(0,4)

    local function refreshList()
        for _, child in ipairs(PlayerList:GetChildren()) do
            if child:IsA("TextButton") then child:Destroy() end
        end
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                local btn = Instance.new("TextButton")
                btn.Size = UDim2.new(1, -10, 0, 30)
                btn.BackgroundColor3 = Color3.fromRGB(60,60,60)
                btn.TextColor3 = Color3.fromRGB(220,220,255)
                btn.Font = Enum.Font.Gotham
                btn.TextSize = 16
                btn.Text = player.Name
                btn.Parent = PlayerList
                local corner = Instance.new("UICorner", btn); corner.CornerRadius = UDim.new(0,5)
                local stroke = Instance.new("UIStroke", btn); stroke.Color = Color3.fromRGB(160,50,255); stroke.Thickness = 1
                btn.MouseEnter:Connect(function() btn.BackgroundColor3 = Color3.fromRGB(70,40,100) end)
                btn.MouseLeave:Connect(function() btn.BackgroundColor3 = Color3.fromRGB(60,60,60) end)
                btn.MouseButton1Click:Connect(function() callback(player, btn) end)
            end
        end
        task.wait(0.1)
        PlayerList.CanvasSize = UDim2.new(0,0,0,ListLayout.AbsoluteContentSize.Y + 10)
    end

    Players.PlayerAdded:Connect(refreshList)
    Players.PlayerRemoving:Connect(refreshList)
    refreshList()
    return PlayerList
end

-- ===== Teleport content =====
do
    local info = Instance.new("TextLabel", TeleportContent)
    info.Size = UDim2.new(1, -10, 0, 20)
    info.Position = UDim2.new(0,5,0,5)
    info.BackgroundTransparency = 1
    info.Text = "เลือกผู้เล่นเพื่อเทเลพอร์ตไปหา"
    info.TextColor3 = Color3.fromRGB(200,200,255)
    info.Font = Enum.Font.Gotham
    info.TextSize = 16
    createPlayerListInParent(TeleportContent, function(player)
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            LocalPlayer.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame + Vector3.new(0,5,0)
        end
    end)
end

-- ===== Fly content =====
do
    local info = Instance.new("TextLabel", FlyContent)
    info.Size = UDim2.new(1, -10, 0, 20)
    info.Position = UDim2.new(0,5,0,5)
    info.BackgroundTransparency = 1
    info.Text = "เลือกผู้เล่นเพื่อบินติดตาม (toggle)"
    info.TextColor3 = Color3.fromRGB(200,200,255)
    info.Font = Enum.Font.Gotham
    info.TextSize = 16

    local following = false
    local targetPlayer = nil
    local followConnection = nil

    createPlayerListInParent(FlyContent, function(player, btn)
        if targetPlayer == player then
            following = false
            targetPlayer = nil
            btn.Text = player.Name
            if followConnection then followConnection:Disconnect() followConnection = nil end
        else
            following = true
            targetPlayer = player
            btn.Text = "Following: "..player.Name
            if followConnection then followConnection:Disconnect() followConnection = nil end
            followConnection = RunService.RenderStepped:Connect(function()
                if following and targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                    LocalPlayer.Character.HumanoidRootPart.CFrame = targetPlayer.Character.HumanoidRootPart.CFrame + Vector3.new(0,5,0)
                end
            end)
        end
    end)
end

-- ===== Mod content (Noclip / Speed / ESP) =====
do
    local info = Instance.new("TextLabel", ModContent)
    info.Size = UDim2.new(1, -10, 0, 20)
    info.Position = UDim2.new(0,5,0,5)
    info.BackgroundTransparency = 1
    info.Text = "Mod: Noclip / Hack Speed / ESP"
    info.TextColor3 = Color3.fromRGB(200,200,255)
    info.Font = Enum.Font.Gotham
    info.TextSize = 16

    -- Noclip
    local noclip = false
    local noclipBtn = Instance.new("TextButton", ModContent)
    noclipBtn.Size = UDim2.new(1,-10,0,35); noclipBtn.Position = UDim2.new(0,5,0,30)
    noclipBtn.Text = "Noclip: OFF"
    styleButton(noclipBtn, 16)
    noclipBtn.TextColor3 = Color3.fromRGB(255,255,255)

    noclipBtn.MouseButton1Click:Connect(function()
        noclip = not noclip
        noclipBtn.Text = "Noclip: " .. (noclip and "ON" or "OFF")
    end)

    -- run noclip in stepped (only one connection)
    RunService.Stepped:Connect(function()
        if noclip and LocalPlayer.Character then
            for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
        end
    end)

    -- Speed
    local speedEnabled = false
    local speedValue = 16
    local SpeedBox = Instance.new("TextBox", ModContent)
    SpeedBox.Size = UDim2.new(1,-10,0,35); SpeedBox.Position = UDim2.new(0,5,0,75)
    SpeedBox.PlaceholderText = "WalkSpeed"; SpeedBox.Text = tostring(speedValue)
    SpeedBox.Font = Enum.Font.GothamBold; SpeedBox.TextSize = 16
    SpeedBox.BackgroundColor3 = Color3.fromRGB(60,60,60); SpeedBox.TextColor3 = Color3.fromRGB(255,255,255)
    local sCorner = Instance.new("UICorner", SpeedBox); sCorner.CornerRadius = UDim.new(0,5)

    local speedBtn = Instance.new("TextButton", ModContent)
    speedBtn.Size = UDim2.new(1,-10,0,35); speedBtn.Position = UDim2.new(0,5,0,115)
    speedBtn.Text = "Hack Speed: OFF"
    styleButton(speedBtn, 16)
    speedBtn.TextColor3 = Color3.fromRGB(255,255,255)

    local function applySpeed(enabled)
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.WalkSpeed = enabled and (tonumber(SpeedBox.Text) or 16) or 16
        end
    end

    speedBtn.MouseButton1Click:Connect(function()
        speedEnabled = not speedEnabled
        speedBtn.Text = "Hack Speed: " .. (speedEnabled and "ON" or "OFF")
        applySpeed(speedEnabled)
    end)

    SpeedBox.FocusLost:Connect(function(enter)
        if enter then
            if speedEnabled then applySpeed(true) end
        end
    end)

    LocalPlayer.CharacterAdded:Connect(function(char)
        char:WaitForChild("Humanoid").WalkSpeed = speedEnabled and (tonumber(SpeedBox.Text) or 16) or 16
    end)

    -- ESP (BillboardGui on Head, shows player.Name)
    local espEnabled = false
    local espMap = {} -- player -> BillboardGui

    local function createESPFor(player)
        if not player.Character then return end
        local head = player.Character:FindFirstChild("Head")
        if not head then return end
        if espMap[player] then return end

        local billboard = Instance.new("BillboardGui")
        billboard.Name = "BomESP"
        billboard.Adornee = head
        billboard.AlwaysOnTop = true
        billboard.Size = UDim2.new(0, 120, 0, 30)
        billboard.StudsOffset = Vector3.new(0, 1.8, 0)
        billboard.Parent = head

        local txt = Instance.new("TextLabel", billboard)
        txt.Size = UDim2.new(1,0,1,0)
        txt.BackgroundTransparency = 1
        txt.Text = player.Name
        txt.Font = Enum.Font.GothamBold
        txt.TextSize = 14
        txt.TextColor3 = Color3.fromRGB(255,255,0)
        txt.TextStrokeTransparency = 0.6

        espMap[player] = billboard
    end

    local function removeESPFor(player)
        if espMap[player] then
            espMap[player]:Destroy()
            espMap[player] = nil
        end
    end

    local espBtn = Instance.new("TextButton", ModContent)
    espBtn.Size = UDim2.new(1,-10,0,35); espBtn.Position = UDim2.new(0,5,0,155)
    espBtn.Text = "ESP: OFF"
    styleButton(espBtn, 16)
    espBtn.TextColor3 = Color3.fromRGB(255,255,0)

    espBtn.MouseButton1Click:Connect(function()
        espEnabled = not espEnabled
        espBtn.Text = "ESP: " .. (espEnabled and "ON" or "OFF")
        if espEnabled then
            -- create for all current players (except local)
            for _, pl in pairs(Players:GetPlayers()) do
                if pl ~= LocalPlayer then
                    createESPFor(pl)
                end
            end
        else
            -- remove all
            for pl, gui in pairs(espMap) do
                if gui then gui:Destroy() end
            end
            espMap = {}
        end
    end)

    -- Keep ESP updated for joining/leaving and character respawns
    Players.PlayerAdded:Connect(function(pl)
        pl.CharacterAdded:Connect(function(char)
            task.wait(0.1)
            if espEnabled and pl ~= LocalPlayer then createESPFor(pl) end
        end)
        if espEnabled and pl ~= LocalPlayer then createESPFor(pl) end
    end)

    Players.PlayerRemoving:Connect(function(pl)
        removeESPFor(pl)
    end)
end

-- ====== Open/Close ======
CloseBtn.MouseButton1Click:Connect(function() MainFrame.Visible = false end)

local OpenBtn = Instance.new("TextButton", ScreenGui)
OpenBtn.Size = UDim2.new(0,40,0,40)
OpenBtn.Position = UDim2.new(0,10,0,200)
OpenBtn.BackgroundColor3 = Color3.fromRGB(80,0,80)
OpenBtn.Text = "BomX"
OpenBtn.TextColor3 = Color3.fromRGB(255,255,255)
OpenBtn.Font = Enum.Font.GothamBold
OpenBtn.TextSize = 24
OpenBtn.Active = true
OpenBtn.Draggable = true
local openCorner = Instance.new("UICorner", OpenBtn); openCorner.CornerRadius = UDim.new(0,12)

OpenBtn.MouseButton1Click:Connect(function() MainFrame.Visible = not MainFrame.Visible end)

UserInputService.InputBegan:Connect(function(input, processed)
    if processed then return end
    if input.KeyCode == Enum.KeyCode.RightShift then
        MainFrame.Visible = not MainFrame.Visible
    end
end)

-- Wire category buttons to subframes
TPBtn.MouseButton1Click:Connect(function() showCategory(TeleportContent, "หมวด: Teleport") end)
FlyBtn.MouseButton1Click:Connect(function() showCategory(FlyContent, "หมวด: Fly") end)
ModBtn.MouseButton1Click:Connect(function() showCategory(ModContent, "หมวด: Mod") end)

-- Default open Teleport
showCategory(TeleportContent, "หมวด: Teleport")

-- End of script
